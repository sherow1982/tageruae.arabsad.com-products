<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>منتجات تاجر الإمارات</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<style>
body { font-family: 'Tajawal', sans-serif; background-color: #f9fafb; }
.grid { display: grid; grid-template-columns: repeat(auto-fill,minmax(200px,1fr)); gap:20px; padding:20px; }
.card { background:#fff; border-radius:10px; box-shadow:0 0 10px rgba(0,0,0,0.1); display:flex; flex-direction:column; transition: transform 0.2s; }
.card:hover { transform: scale(1.05); }
.card img { width:100%; height:200px; object-fit:cover; border-radius:8px 8px 0 0; cursor:pointer; }
.card-content { padding:10px; flex-grow:1; display:flex; flex-direction:column; justify-content:space-between; }
.title { font-weight:bold; color:#444; margin-bottom:5px; }
.price-old { color:red; text-decoration:line-through; font-size:14px; }
.price-new { color:green; font-weight:bold; font-size:18px; margin-bottom:5px; }
.btn { background:#007bff; color:#fff; padding:8px; border-radius:6px; text-align:center; text-decoration:none; margin-top:auto; transition:0.2s; display:block; }
.btn:hover { background:#0056b3; }
</style>
</head>
<body>
<h1 class="text-3xl font-bold text-center text-blue-700 my-6">منتجات تاجر الإمارات</h1>
<div class="grid" id="products"></div>

<script>
const FEED_URL = "https://api.easy-orders.net/api/v1/products/feed/437a38bb829245a3934e1d2fe153b417/channel/meta";

async function loadProducts() {
  try {
    const res = await fetch(FEED_URL); // يعتمد على الفييد مباشرة
    const data = await res.json();
    const container = document.getElementById("products");

    data.items.forEach(item => {
      const card = document.createElement("div");
      card.className = "card";

      const link = document.createElement("a");
      link.href = item.link;
      link.target = "_blank";

      const img = document.createElement("img");
      img.src = item.image_link || item.image || "";
      img.alt = item.title;

      link.appendChild(img);
      card.appendChild(link);

      const content = document.createElement("div");
      content.className = "card-content";

      const title = document.createElement("div");
      title.className = "title";
      title.textContent = item.title;

      const priceOld = document.createElement("div");
      priceOld.className = "price-old";
      priceOld.textContent = item.price ? item.price + " درهم" : "";

      const priceNew = document.createElement("div");
      priceNew.className = "price-new";
      priceNew.textContent = item.sale_price ? item.sale_price + " درهم" : item.price + " درهم";

      const btn = document.createElement("a");
      btn.className = "btn";
      btn.href = item.link;
      btn.target = "_blank";
      btn.textContent = "اشترِ الآن";

      content.appendChild(title);
      content.appendChild(priceOld);
      content.appendChild(priceNew);
      content.appendChild(btn);

      card.appendChild(content);
      container.appendChild(card);
    });
  } catch (err) {
    console.error("خطأ في تحميل المنتجات:", err);
    document.getElementById("products").innerHTML = "<p class='text-center text-red-500'>حدث خطأ في تحميل المنتجات. ممكن يكون السبب CORS.</p>";
  }
}

loadProducts();
</script>
</body>
</html>
